<html>

<head>
    <link rel="stylesheet" type="text/css" href="../css/main.css"> 
    <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans" rel="stylesheet"> 
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta name="google-signin-client_id" content="212991127628-8rj19c00v2d1tpl9v3rpd2vd740o6d96.apps.googleusercontent.com">
  <script>
    function onSignIn(googleUser) {
      var id_token = googleUser.getAuthResponse().id_token;
      var xhr = new XMLHttpRequest();
      const reply = { idToken: id_token };
      xhr.open('POST', '/actuallylogin');
      xhr.onreadystatechange = function () {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          if (xhr.status == 200) {
            window.location = "/";
          }
          else {
            window.location = "/logout";
          }
        }
      }
      xhr.setRequestHeader("content-type", "application/json")
      console.log("I WAS TOKEN WITH THIS: " + id_token);
      xhr.send(JSON.stringify(reply));
    }
  </script>
</head>

<body>

  <main>
    <section class="middle-box">
        <h1>Photo Garden</h1>
      <div class="g-signin2" data-scope="https://www.googleapis.com/auth/drive.readonly" data-onsuccess="onSignIn"></div>
    </section>
  </main>
</body>

</html>